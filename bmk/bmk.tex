\graphicspath{{./bmk/figures/}}
\chapter{Benchmarks} \label{ch:bmk}
\section{Introduction}
Having developed the ensemble, PES, and PDF mathematics in chapters \ref{ch:pes_e} and \ref{ch:pdf} this chapter will now benchmark the system to check its ability to produce reasonable structures from PDFs.
The benchmarks shown here are certainly not exhaustive, nor are they the even all the benchmarks run against the NUTS-HMC system.
However, they do provide a good window into the workings, limitations, and abilities of the system.

The formation of NPs with both crystallographic and non-crystallographic structures \cite{Marks1994} and with different chemical patterns \cite{Ferrando2008} are well documented.
For simplicity, we chose monometallic Au clusters as benchmarks and considered two groups of structures with different size and degrees of structural disorder in order to assess the reliability and efficiency of our HMC method for solving atomic structures from PDFs.
The first group consists of \ce{Au55} clusters with different degrees of disorder, including a crystalline cluster structure in $O_h$ (Octahedral) symmetry, a structure with a disordered surface, and an amorphous structure.
The second group consists of the crystallographically solved \ce{Au102} structure as in the \ce{Au102MBA44} nanocrystals \cite{Jadzinsky2007,Li2008}.
We used optimized structures from the Density Functional Theory (DFT) as target structures and generated the corresponding PDF, $G_{_\mathrm{obs}}$, according to
\begin{equation}\label{Eq:Gdef}
  G_{_\mathrm{obs}} = \frac{2}{\pi} \int_{Q_\mathrm{min}}^{Q_\mathrm{max}} Q[S_{_\mathrm{obs}}(Q) - 1] \sin{\left (Q r \right )}\, dQ
\end{equation}
where $S_{_\mathrm{obs}}$ is the target structure's structure factor.
Since all the target structures were optimized by DFT at zero Kelvin the target and model PDF profiles were calculated at zero temperature, with no atomic displacement parameters (ADPs).
However, ADPs would have a considerable impact on the calculation of the PDF, especially for nanoparticles at non-zero temperatures.

\subsection{Target Setup}
Spin-polarized  DFT calculations were carried out using the Vienna ab initio simulation package (VASP) \cite{Kresse1993, Kresse1994} within the  Perdew-Burke-Ernzerhof (PBE) exchange-correlation functional \cite{PERD1996}.
The projected augmented wave method \cite{Blochl1994} and a kinetic energy cutoff of 400 eV were used.
Structural optimization was performed until the total energy and ionic forces were converged to 10$^{-6}$ eV and 10 meV/\AA, respectively.
The  amorphous \ce{Au55} structures were generated by simulated annealing using the classical embedded atom method potential \cite{Sheng2011}.
Different annealing temperatures between 1200 K and 1670 K (bulk melting temperature of Au) were used and the thermally equilibrated structures were cooled down to 300 K before minimization at 0 K.
Further optimization using DFT leads to total energies that vary within 1-2 eV among different amorphous structures  and the lowest energy one was used as the target structure. The target structure of \ce{Au102} was taken as the \ce{Au102} core of the DFT-optimized \ce{Au102MBA44} cluster \cite{Li2008}.

All systems were solved using a PES  which consists of a linear combination of $Rw$, the repulsive and attractive thresholded spring potentials.  The total potential energy in the Hamiltonian in Eq. (\ref{Hamiltonian}) is expressed as:
\begin{eqnarray}\label{eq:Ucomp}
  U(q) = U_{Rw}(q) + U_\mathrm{spring}(q, R_\mathrm{min}) + U_\mathrm{spring}(q, R_\mathrm{max})
\end{eqnarray}
The thresholded spring potentials are based on those previously proposed on by Peterson \cite{Peterson2014}, i.e.  $U_\mathrm{spring}(q, r_{t}) = \frac{\kappa}{2}\sum_{i, j}(r_{i, j}-r_t)^{2}$  for all atomic distance $r_{i,j}$  outside the bounds of the spring threshold $r_t$.
The resulting restoring forces on the out-of-bound atoms  bring the system back within the bounds of the PDF, $R_\mathrm{min}$ and $R_\mathrm{max}$, and therefore preventing the system from exploding or collapsing.
Otherwise,  incorrect solutions may result by having atomic pair distances out of the PDF bounds.  $\kappa$ is the spring constant in eV/\AA~and the $Rw$ potential is converted from unitless to eV via multiplication by a conversion factor $\lambda$.

Whereas the choice of the absolute values of $\lambda$ and $\kappa$ is somewhat arbitrary, their relative values are important in determining which  term in Eq.~(\ref{eq:Ucomp}) dominates the PES, especially when considering the effect of the simulation temperature.
Generally, the ratio between the total potential energy and the temperature determines how much random motion will dominate the dynamics; a lower ratio implies that random motion will play a large role in the dynamics.
The ratio between $\lambda$ and $\kappa$ of each spring describes how far the PDF can push the system below or above the bounds set by the spring potentials.
Heuristically, too stiff a spring  forbids the system to access new configurations, e.g.  high energy ``transition states'' which may involve shorter bonds or a larger system size.
Conversely, too small a spring constant makes it slower for the system to snap back within bounds and may lead to an explosion or implosion of the system, leaving the dynamics to drift aimlessly.

\subsection{Model Parameters}
Unless otherwise stated, the PDFs of the target and starting structures were generated using Eqn. (\ref{Eq:Gdef}) with a step of $\delta R=.01$~\AA, $Q_\mathrm{min}=0.1$~\AA$^{-1}$,  $Q_\mathrm{max}=25.0$~\AA$^{-1}$.
 $R_\mathrm{min}$ and $R_\mathrm{max}$ correspond to the first minimum before the first PDF peak and that after the last PDF peak, respectively, which ensure that the full meaningful region of the PDF is modeled.  For each of the simulations, the Q resolution was calculated by
\begin{equation}
\delta Q=\frac{\pi} {R_\mathrm{max} + \frac{12 \pi}{Q_\mathrm{max}}}
\end{equation}

The HMC simulation was run with $N=300$  iterations, a target acceptance rate of 0.65, and an average starting momentum for each NUTS iteration  of 10 eVfs/\AA. Both  repulsive and attractive spring potentials are used with $\kappa=200$ eV/\AA ~and thresholds matching $R_\mathrm{max}$ and $R_\mathrm{min}$ of the PDF, respectively.  $\lambda=$ 300 eV was used as conversion factor for $Rw$. Each simulation was run with a pair of NVIDIA GTX970 graphics cards, with one card partially occupied with desktop visualization.

\section{Structural Solutions}
\subsection{Case I: crystalline \ce{Au55}}
We first test our algorithm by solving the crystalline \ce{Au55} ($c$-\ce{Au55}) cluster structure from its PDF.
The starting structure is taken as the bulk-cut cuboctahedron of \ce{Au55}  with a uniform bond length of 2.89~\AA.
Due to finite-size and surface effects, the DFT-relaxed cluster structure shows a distinctively different bond length distribution as a function of the bond's distance to the cluster center of mass, and therefore is difficult to model with a small box approach which assumes an identical unit cell throughout the whole system.

 $R_\mathrm{min}$ and $R_\mathrm{max}$ for this simulation were 2.45 \AA ~and 11.4 \AA, respectively, with $\delta Q=0.24$~\AA$^{-1}$. The simulation ran for approximately 34 minutes, over a total of $\sim$40 thousand configurations.  The results are shown in Fig. \ref{fig:Au55 bulk -> DFT, metrics}.
\begin{figure}
  \def \localimgpath {./Au_55_DFT_HMC_paper_final/55d7ccded2d355710ddb3fdf}
  \centering
  \captionsetup[subfigure]{labelformat=simple}
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_min_colorbond.png}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_pdf}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_rbonds}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_angle}}\quad

   \caption{\ce{Au55} PDF fitting of DFT-optimized $c$-\ce{Au55}. a) the final structural solution ($Rw$=0.3\%) with  bond lengths color-coded by step of 0.05\AA, b) the target PDF(blue dots) overlaid with the PDF of the final structure (solid red lines) with the difference in green lines offset below, c) the radial bond distribution, and d) bond angle distribution.  }
         \label{fig:Au55 bulk -> DFT, metrics}
\end{figure}

The PDF, radial bond distribution, and bond angle distribution show good agreement between the target and final fitted structures, with a $Rw$ of 0.3\% whereas $Rw$ of the starting structure is as high as 44.8\%. DFT calculations yield a total energy of the final structure very close to that of the target structure (within a few meV). The success in the fitting is largely attributed to the factor that the target structure is only locally (and mildly) disturbed from its bulk-like counterpart and therefore there is no need to overcome any high PES barriers to reach the correct solution. As shown below, the situation is rather different for much more disordered target structures. Interestingly, the small-box solution using PDFgui\cite{Farrow2007} yields a rather large $Rw$ of 43\%, due to the failure to fit the surface contracted atoms with a unit cell. The PDF fits of the starting structure and small-box solution are shown in Fig. S1 in the Supporting Information.

\subsection{Case II: \ce{Au55} with surface disorder}
In addition to surface relaxation, the  structure of a cluster or nanoparticle is often disrupted by the presence of defects and/or ligand bound to the surface.  To mimic such surface disorders, we took the DFT-optimized $c$-\ce{Au55} structure from case I as the starting structure and randomly displaced the surface atoms with a normal distribution of $\sigma = 0.2$ \AA. All atoms are allowed to move in the HMC simulation, including the originally undisturbed core, which is a \ce{Au13} cluster with $O_h$ symmetry.

 $R_\mathrm{min}$ and $R_\mathrm{max}$ for this simulation were 1.95 \AA ~and 12.18 \AA, respectively, with $\delta Q=0.23$~\AA$^{-1}$.
The simulation ran for approximately 3.6 hours, over a total of $\sim$270 thousand configurations.
The results of the simulation are shown in Fig. \ref{fig: Au55 surface}.
\begin{figure}
  \def \localimgpath {./Au_55_DFT_distorted_HMC_paper_final/55d7d4c7d2d355710ddb3fe2}
  \centering
  \captionsetup[subfigure]{labelformat=simple}
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_pdf}\label{pdf}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_coord}\label{coord}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_target.png}\label{target}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_rbonds}\label{rbonds}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_angle}\label{angle}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_min.png}\label{min}}\quad

  \caption{\ce{Au55} PDF fitting of surface-disordered \ce{Au55}.
  \protect\subref{pdf} the comparison of PDFs,
  \protect\subref{coord} the CN distribution,
  \protect\subref{target} the target structure,
  \protect\subref{rbonds} the radial bond distribution,
  \protect\subref{angle} the bond angle distribution,
  and \protect\subref{min} the final structural solution ($Rw$=0.6\%)
  }
	\label{fig: Au55 surface}
\end{figure}

Overall, good agreement is found between PDFs of the target structure and the final structural solution, even out to larger $r$, with an $Rw=0.6\%$ starting from an $Rw=50.4\%$ (see Fig. S2).   The radial bond distribution and angle distribution show reasonably  good agreement, but with lower degree of crystallinity in the final structure compared to the target structure. The discrepancy is most obvious in the core:  despite the identical core structure in the starting and target structures, the core atoms were displaced in the HMC simulations in order to achieve a ``best'' solution.  This is  because PDF measures the global average of interatomic distances between each atomic pair and does not contain direct information about the locality of such pairs, e.g. on the surface or cores. If such information is obtained a priori, for example, from theoretical prediction or other experimental measurements, the core structure can  then be fixed and excluded from HMC dynamics.

Similar discrepancies are found in the CN distribution. Since the initial displacements of the surface atoms are relatively mild, the interatomic connectivities remain more or less the same and therefore the target structure has an identical CN distribution to the starting (unperturbed) structure. This is, however, not the case for the final fitted structure, which shows discernible differences, especially at the low and high CN numbers. This is partly caused by the  displacement of the core atoms mentioned above, and partly by the lack of CN constraints  for the PDF fitting, which has been previously demonstrated in the case of  $\alpha$-Si \cite{Cliffe2010}. Additional experimental data, e.g. from EXAFS or NMR, may help to steer the simulations towards better agreement in both PDF and CN distribution.

\subsection{Case III: amorphous \ce{Au55}}
Next, we turn to the case in which the entire cluster structure is disordered. We used a DFT-optimized amorphous \ce{Au55} ($a$-\ce{Au55}) as the target structure, and
 the DFT-relaxed $c$-\ce{Au55} cluster from Case I as the starting structure. The  total energy of $a$-\ce{Au55} was computed to be  {\em lower} than that of $c$-\ce{Au55} by as large as 2.9 eV, consistent with the 3.0 eV found in previous DFT work~\cite{DaSilva2010}.

 $R_\mathrm{min}$ and $R_\mathrm{max}$ for this simulation were 2.6 \AA ~and 11.26 \AA, respectively, with $\delta Q=0.25$~\AA$^{-1}$. The simulation ran for approximately an hour,  over a total of $\sim$87 thousand configurations.  The results of the simulation are shown in Fig.~\ref{fig:Au55 amorphous}.
\begin{figure}
    \def \localimgpath {./Au_55_DFT_amorphous_HMC_paper_final/55d80747d2d355710ddb3fe5}
    \centering
  \captionsetup[subfigure]{labelformat=simple}
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_pdf}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_coord}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_target.png}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_rbonds}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_angle}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_min.png}}\quad

  \caption{Similar to figure \ref{fig: Au55 surface} for  DFT-optimized amorphous \ce{Au55}. }
        \label{fig:Au55 amorphous}
\end{figure}

Our PDF fitting yielded a final structure of  $Rw$ of 1.7\%, whereas that of the initial structure is as high as 76.1\% (see Fig. S3 ), due to the drastically different atomic structure of the crystalline and amorphous \ce{Au55} clusters.
 Overall reasonable agreement in PDF, bond angle distribution, and radial bond distance distribution was found,  and the wide spread of the bond lengths was qualitatively reproduced.
 However, the mismatch in CNs is  problematic, partly due to the lack of information and/or constraints on the CNs.
The total energy of the final structure is computed to be $\sim 6$ eV higher than that of the target structure and the difference is substantially larger then the variation among different amorphous structures computed by DFT ($\Delta E_\mathrm{tot}\sim \pm$ 1-2 eV). Such a fitting result, despite the rather small $Rw$, clearly indicates the importance of complementary information and/or constraints necessary for reliably solving disordered NP structures from PDF.

\subsection{Case IV: ligand-protected \ce{Au102}}
Our final benchmark is \ce{Au102}, whose structure was initially solved by Jadzinsky and co workers using x-ray crystallography \cite{Jadzinsky2007} and further confirmed by DFT studies \cite{Li2008}. The \ce{Au102} structure consists of three main parts, a 49-atom Marks decahedron core, two $C_{5}$ caps consisting of 20 atoms each, and 13 equatorial atoms. Unlike previous cases, the multi-symmetry nature of the structure, i.e. each part has its own distinct symmetry,  poses a  challenge for PDF-based solution of the structure. This is because of the atomically centralized nature of the PDF, in which each atom ``sees'' a density of other atoms surrounding it and has a strong tendency towards becoming the center of the main symmetry group. Such tendency may lead to a solution where some of the correct atomic symmetries are discarded in favor of the core symmetry.

\subsubsection{ Starting from fcc structure}
The starting structure was generated by a spherical cut of the fcc bulk lattice, with two surface atoms removed to conserve the total number of Au atoms.

 $R_\mathrm{min}$ and $R_\mathrm{max}$ for this simulation were 2.7 \AA ~and 16. \AA, respectively, with $\delta Q=0.18$~\AA$^{-1}$. The simulation ran for approximately two hours, over a total of $\sim$82 thousand configurations.  The results of the simulation are shown in Fig.~\ref{fig:Au102_fcc}.
\begin{figure}
  \def \localimgpath {Au_102_HMC_paper_final/55d7b3d4d2d355710ddb3fdc}
  \centering
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_pdf}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_coord}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_target.png}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_rbonds}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_angle}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_min.png}}\quad


  \caption{Similar to Fig.~\ref{fig: Au55 surface} for  \ce{Au102} as in DFT-optimized \ce{Au102MBA44} cluster.}
  \label{fig:Au102_fcc}
\end{figure}

The initial structure of an fcc bulk-cut cluster, had a starting $Rw$ of 77.6\% (see Fig. S4), whereas the final structure has a $Rw$ as low as 8.1\%.
The disagreement between the final and target PDFs shows that the majority of the error is in the high $R$ region, which is related to the long range distances between the core, caps, and equatorial atoms.
The agreement for other structural metrics is less satisfactory. The bond angle distribution for core atoms in the final structure has a poor correlation with those in the target structure, with much broader peak widths.
This is likely caused by the high kinetic barrier to change from one high-symmetry core structure (fcc) to another (Marks Decahedron). In contrast,
the bond angle distribution for surface atoms, which are of lower symmetry than the core, show a much better agreement.
This is due to the preference of Monte Carlo techniques for higher entropy, and thus lower symmetry, structures.
Similarly, the radial bond distance does not show the correct clustering of bond lengths as expected from an ordered structure, indicating the amorphous nature of our fit.
Finally, the CN distribution shows the largest discrepancy at CN=12, again due to the amorphous nature of the fit. Overall, the structural metrics beyond the PDF indicate the poor agreement between the final and target structures.
A higher simulation temperature, potentially combined with CN or bond length aware potentials (such as DFT or EXAFS derived PESs) may help to resolve this discrepancy.

\subsubsection{Starting from Marks Decahedron}
The starting structure, a Marks Decahedron, was generated by the ASE Cluster tool with 2  atoms on the [100] face normal to the 5-fold axis, 3 atoms on the [100] plane parallel to the 5-fold axis and, 1 atom deep Marks reentrance.  This produced a structure with 101 atoms which was extended by one more Au atom to fill out the \ce{Au102} structure.

$R$ bounds and Q resolution were the same as the previous case. The simulation ran for approximately 2.5 hours over a total of $\sim$90 thousand configurations.  The results of the simulation are shown in Fig.~\ref{fig:Au102_deca}.

\begin{figure}
  \def \localimgpath {Au_102__deca_HMC_paper_final/55db6901d2d3552df4f6c86f}
  \captionsetup[subfigure]{labelformat=simple}
  \centering
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_pdf}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_coord}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_target.png}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_rbonds}}\quad
    \subfloat[]{\includegraphics[width=.37\textwidth]{\localimgpath_angle}}\quad
    \subfloat[]{\includegraphics[width=.2\textwidth]{\localimgpath_min.png}}\quad

  \caption{Similar to Fig.~\ref{fig:Au102_fcc} with Marks decahedron as the starting structure.}
  \label{fig:Au102_deca}
\end{figure}

The starting structure of Marks decahedron ($Rw$=56.6\% , see Fig. S5) yielded a better structural solution, with a final $Rw$ of 3.3\%.
However, the discrepancies at high $R$ remains as in the previous case. By examining the final structure, we can see that these high $R$ errors are due to a lack of the two 20-atom caps and 13 equatorial atoms. Similarly, the radial bond distance distribution displays a diffusive behavior unlike the bond length clustering in the target structure.
Compared to the previous case, the agreement in the CN and bond angle distributions are improved, with the latter  capturing nearly all peaks in the target structure with the exception of the 110\degree ~bond angle.
Relatively large discrepancies are found in the CN distribution at the low and high ends.

\section{Discussion and Conclusion}
The challenge of NP structure determination from X-ray Diffraction stems from the absence of long range atomic ordering and the presence of non-trivial disordered structures.
PDF data analysis is one of the successful experimental methods for solving NP structures, which has been tested on varieties of NP structures using non-crystallographic large box hybrid methods \cite{Petkov2014}.
In this work, we developed  a novel, HMC-based  method to solve the structures of NPs from PDFs. We chose monometallic Au clusters as benchmarks and generated synthetic experimental PDF data from DFT-optimized cluster structures. Two cluster sizes (\ce{Au55} and \ce{Au102}) and different degree of disorders (crystalline, surface disordered,  amorphous, ligand-protected)  were considered, which pose further challenges in addition to the lack of long-range order in finite-size systems.

The quality of the PDF fit, as measured by the agreement factor $Rw$, is expected to provide a basis for the comparison between the fit structure and the target structure. The HMC method is designed to find minima in the $Rw$ PES and therefore the ultimate criterion for its success is the magnitude of the $Rw$ values. This criterion has been met in the cases of surface relaxed $c$-\ce{Au55}, surface distorted-Au55, and $a$-\ce{Au55} systems, where we obtained an excellent fits with  $Rw<$ 2\%.
With most of the modeling methods a PDF fit with an $Rw<$ 15\% would be considered a solved structure \cite{Petkov2014, Emil, Masadeh2007, Shi2014, Petkov2012}.
However, a low $Rw$ does not necessarily translate into the correct structural solution and the discrepancies may be caused by several different factors.
For example, the disordered surfaces associated with NPs produces a fall off in the PDF profile, resulting in underestimated NP sizes in the fitted structures \cite{Petkov2014}.
In addition, as the PDF profile depends on the average core and surface pair distributions, the structural solution may not be unique especially for disordered systems. This is best manifested in the example of amorphous \ce{Au55}, in which the final structure produces a rather small $Rw$ but has distinctively different structural features and a much higher total energy compared to the target structure. In order to faithfully solve the structures, other fitting metrics, such as the atomic coordination numbers, may need to be considered.  For  ordered or partially ordered systems, we have demonstrated  a reasonable agreement between the final and target CN distributions, whereas the discrepancy increases for disordered structures.  A hybrid HMC method combining with other experimental  (EXAFS, NMR) or computational (DFT, force field)  methods is expected to provide more physical constraints, e.g. CN distribution,  in the PDF fitting and result in better structural agreement.

The case of ligand-protected \ce{Au102},  a crystallographically well solved NP system by X-ray diffraction, provides a unique test for the HMC algorithm due to its multi-symmetry nature and very short range ordering.  The structure of \ce{Au102}  was solved using two different starting crystal structures, i.e. fcc and Mark decahedron. The  $Rw$ values support the Marks decahedron structure of the cluster core over the fcc one, but discrepancies are found at high $R$ values.  This could be explained as limitation of the method while using PDF profile fit for high symmetry local structures such as cap atoms in \ce{Au102}, which has a $C_{5}$ symmetry.  This is an intrinsic problem with the PDF, which measures the global inter-atomic distances, thus causing each atom to see itself at the epicenter of the majority symmetry.
Use of additional techniques, like EXAFS, which has an emphasis on the local coordination spheres, may help with finding better minima by breaking the dominant symmetry and providing a low energy path to compartmentalized structures.

In summary, we present the development of a novel Hamiltonian Monte Carlo based method for finding atomic structure solutions to PDFs.   We derived the analytical derivatives of $Rw$, $G(r)$, and $F(Q)$, which were used to guide the Hamiltonian dynamics to follow the gradient of the PES towards minimum energies.  The matrix element algebra inherent to the Debye sum and its derivatives lent itself to be written as GPU kernels, allowing for the speedup of the HMC algorithm by massive parallelization.  The GPU implementation is 100 to 4x faster than the comparable multi-core CPU enabled code, depending on the size of the NP.  The  robustness and accuracy of the HMC method was benchmarked against a set of Au cluster structures of different size and degree of disorder.  Overall,  low $Rw$ values were obtained for all the benchmarks, with most of the structural features reproduced as shown by various structural metrics.  The \ce{Au102} cluster, which contains both high symmetry local structures and disordered surface regions,  posed the largest challenge. Although the fitted structure shows some dependence on two starting configurations,  neither of them was able to fully solve the target structure.
Future work which employs experimentally derived potentials, including EXAFS, or computational potentials that contain chemical bonding information, may help to solve these particularly difficult cases.
Work is underway to extend this method to the grand canonical ensemble and parallel tempering, which will allow for solving structures with unknown number of atoms and compositions and provide better stochastic mixing of structures.